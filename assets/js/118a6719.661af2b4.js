"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2859],{77359:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>d});var i=t(85893),o=t(11151);const c={hide_table_of_contents:!0},l=void 0,s={id:"reference/python-sdk/weave",title:"weave",description:"The top-level functions for Weave Trace API.",source:"@site/docs/reference/python-sdk/weave.md",sourceDirName:"reference/python-sdk",slug:"/reference/python-sdk/weave",permalink:"/weave/reference/python-sdk/weave",draft:!1,unlisted:!1,editUrl:"https://github.com/wandb/weave/blob/master/docs/docs/reference/python-sdk/weave.md",tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"pythonSdkSidebar"},r={},d=[{value:"The top-level functions for Weave Trace API.",id:"the-top-level-functions-for-weave-trace-api",level:2},{value:"<kbd>function</kbd> <code>init</code>",id:"function-init",level:3},{value:"<kbd>function</kbd> <code>publish</code>",id:"function-publish",level:3},{value:"<kbd>function</kbd> <code>ref</code>",id:"function-ref",level:3},{value:"<kbd>function</kbd> <code>get_current_call</code>",id:"function-get_current_call",level:3},{value:"<kbd>function</kbd> <code>finish</code>",id:"function-finish",level:3}];function a(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"the-top-level-functions-for-weave-trace-api",children:"The top-level functions for Weave Trace API."}),"\n",(0,i.jsxs)(n.h3,{id:"function-init",children:[(0,i.jsx)("kbd",{children:"function"})," ",(0,i.jsx)(n.code,{children:"init"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"init(\n    project_name: str,\n    settings: Optional[weave.trace.settings.UserSettings, dict[str, Any]] = None\n) \u2192 WeaveClient\n"})}),"\n",(0,i.jsx)(n.p,{children:"Initialize weave tracking, logging to a wandb project."}),"\n",(0,i.jsx)(n.p,{children:"Logging is initialized globally, so you do not need to keep a reference to the return value of init."}),"\n",(0,i.jsx)(n.p,{children:"Following init, calls of weave.op() decorated functions will be logged to the specified project."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Args:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("b",{children:(0,i.jsx)(n.code,{children:"project_name"})}),":  The name of the Weights & Biases project to log to."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"}),"\nA Weave client."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"function-publish",children:[(0,i.jsx)("kbd",{children:"function"})," ",(0,i.jsx)(n.code,{children:"publish"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"publish(obj: Any, name: Optional[str] = None) \u2192 ObjectRef\n"})}),"\n",(0,i.jsx)(n.p,{children:"Save and version a python object."}),"\n",(0,i.jsx)(n.p,{children:"If an object with name already exists, and the content hash of obj does not match the latest version of that object, a new version will be created."}),"\n",(0,i.jsx)(n.p,{children:"TODO: Need to document how name works with this change."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Args:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("b",{children:(0,i.jsx)(n.code,{children:"obj"})}),":  The object to save and version."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("b",{children:(0,i.jsx)(n.code,{children:"name"})}),":  The name to save the object under."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"}),"\nA weave Ref to the saved object."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"function-ref",children:[(0,i.jsx)("kbd",{children:"function"})," ",(0,i.jsx)(n.code,{children:"ref"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"ref(location: str) \u2192 ObjectRef\n"})}),"\n",(0,i.jsx)(n.p,{children:"Construct a Ref to a Weave object."}),"\n",(0,i.jsx)(n.p,{children:"TODO: what happens if obj does not exist"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Args:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("b",{children:(0,i.jsx)(n.code,{children:"location"})}),':  A fully-qualified weave ref URI, or if weave.init() has been called, "name',":version",'" or just "name" ("latest" will be used for version in this case).']}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"}),"\nA weave Ref to the object."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"function-get_current_call",children:[(0,i.jsx)("kbd",{children:"function"})," ",(0,i.jsx)(n.code,{children:"get_current_call"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"get_current_call() \u2192 Optional[ForwardRef('Call')]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Get the Call object for the currently executing Op, within that Op."}),"\n",(0,i.jsx)(n.p,{children:"This allows you to access attributes of the Call such as its id or feedback while it is running."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@weave.op\ndef hello(name: str) -> None:\n     print(f"Hello {name}!")\n     current_call = weave.get_current_call()\n     print(current_call.id)\n'})}),"\n",(0,i.jsx)(n.p,{children:"It is also possible to access a Call after the Op has returned."}),"\n",(0,i.jsxs)(n.p,{children:["If you have the Call's id, perhaps from the UI, you can use the ",(0,i.jsx)(n.code,{children:"call"})," method on the ",(0,i.jsx)(n.code,{children:"WeaveClient"})," returned from ",(0,i.jsx)(n.code,{children:"weave.init"})," to retrieve the Call object."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'client = weave.init("<project>")\nmycall = client.call("<call_id>")\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Alternately, after defining your Op you can use its ",(0,i.jsx)(n.code,{children:"call"})," method. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@weave.op\ndef hello(name: str) -> None:\n     print(f"Hello {name}!")\n\nmycall = hello.call("world")\nprint(mycall.id)\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"}),"\nThe Call object for the currently executing Op, or  None if tracking has not been initialized or this method is  invoked outside an Op."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"function-finish",children:[(0,i.jsx)("kbd",{children:"function"})," ",(0,i.jsx)(n.code,{children:"finish"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"finish() \u2192 None\n"})}),"\n",(0,i.jsx)(n.p,{children:"Stops logging to weave."}),"\n",(0,i.jsx)(n.p,{children:"Following finish, calls of weave.op() decorated functions will no longer be logged. You will need to run weave.init() again to resume logging."})]})}function h(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>s,a:()=>l});var i=t(67294);const o={},c=i.createContext(o);function l(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);